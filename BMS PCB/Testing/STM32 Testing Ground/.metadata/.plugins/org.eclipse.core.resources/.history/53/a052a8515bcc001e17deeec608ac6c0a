/* Includes ------------------------------------------------------------------*/
#include "main.h"
#include "stm32l4xx.h"

/* Function Prototypes -------------------------------------------------------*/
void initClocks(void);
void configSPI(void);

/**
  * @brief  The application entry point.
  * @retval int
  */
int main(void)
{
	initClocks();
	configSPI();
}

/* Function definitions ------------------------------------------------------*/
void initClocks(void) {
	RCC->AHB2ENR |= 0x00000003; // Enable AHB2 peripheral clock for GPIOA and GPIOB
	RCC->APB2ENR |= 0x00001000;
}

void configSPI(void) {
	GPIOA->MODER &= (~(0x0000FC00));
	GPIOB->MODER &= (~(0x00000003));
	GPIOA->AFR[0] &= (~(0xFFF00000));
	GPIOB->AFR[0] &= (~(0x0000000F));

	GPIOA->MODER |= 0x0000A800; // Set PA5-7 to alternate function mode
	GPIOB->MODER |= 0x00000002; // Set PB0 to alternate function mode

	GPIOA->AFR[0] |= 0x55500000; // Set PA5-7 to AF5 (SPI1)
	GPIOB->AFR[0] |= 0x00000005; // Set PB0 to AF5 (SPI1)
}
